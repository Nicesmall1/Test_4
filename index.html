<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Сделки</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#FFFFFF;
  --card:#FFFFFF;
  --text:#000000;
  --muted:#666666;
  --accent:#EF3124;
  --border:#E0E0E0;
  --blue:#0047FF;
}
*{box-sizing:border-box; margin:0; padding:0}
body{
  margin:0;
  padding:19.2px;
  background:var(--bg);
  color:var(--text);
  font-family:"San Francisco Pro", -apple-system, BlinkMacSystemFont, sans-serif;
  font-weight:400;
  font-size:12.8px;
  line-height:1;
}

/* Показывать/скрывать фрагменты в зависимости от вьюпорта */
.only-mobile { display: none; }
.desktop-only { display: inline; }
@media (max-width: 800px) {
  .only-mobile { display: inline-block; }
  .desktop-only { display: none; }
}

/* Мелкие мобильные доработки — ПОЧИНЕНО: 350px (не 350x) */
@media (max-width: 350px) {
  body { padding: 10px; font-size: 16px; -webkit-text-size-adjust: 100%; }
  h1 { font-size: 28px; line-height: 1.2; margin: 0 0 20px; text-align: center; }
  .container { padding: 0 10px; width: 100%; max-width: 100%; }
  .toolbar { gap: 12px; flex-direction: column; align-items: stretch; margin: 20px 0 15px; }
  .search { min-width: 100%; order: 1; }
  input[type="search"] { padding: 12px 16px; font-size: 16px; }
  .kpis { order: 2; justify-content: space-around; gap: 8px; flex-wrap: wrap; }
  .kpis .chip { font-size: 14px; padding: 8px 12px; flex: 1; min-width: 100px; text-align: center; }
  .filters { order: 3; justify-content: center; flex-wrap: wrap; gap: 6px; }
  button.filter { font-size: 12px; padding: 10px 12px; flex: 1; min-width: 80px; }
  .table-wrap { margin-bottom: 20px; max-height: calc(100vh - 250px); overflow: auto; -webkit-overflow-scrolling: touch; border-radius: 8px; width: 100%; }
  table { width: 100%; min-width: 100%; }
  thead th, tbody td { padding: 10px 8px; font-size: 12px; }
  .badge, .status { font-size: 11px; padding: 5px 8px; white-space: nowrap; }
  .footer { font-size: 12px; margin-top: 15px; }
}

@media (max-width: 350px) {
  body { overflow-x: hidden; width: 100%; }
  .rwd-table, .rwd-table tbody, .rwd-table tr, .rwd-table td { box-sizing: border-box; }
  tbody td { word-break: break-word; max-width: 120px; overflow: hidden; text-overflow: ellipsis; }
}

.container{ max-width:1400px; margin:auto; padding:0 19.2px; }
h1{
  font-family:"San Francisco Pro", -apple-system, BlinkMacSystemFont, sans-serif;
  font-weight:700;
  font-size:64px;
  line-height:60.8px;
  margin:0 0 32px;
  text-transform:lowercase;
}
.toolbar{
  display:flex; gap:19.2px; flex-wrap:wrap; align-items:center;
  margin:32px 0 24px; justify-content:space-between;
}
.search{flex:1;min-width:300px;max-width:400px}
input[type="search"]{
  width:100%; padding:9.6px 12.8px; border:1px solid var(--border);
  border-radius:10px; background:var(--card); color:var(--text); outline:none;
  font-family:"San Francisco Pro", -apple-system, BlinkMacSystemFont, sans-serif;
  font-weight:400; font-size:12.8px; line-height:1;
}
.kpis{ display:flex; gap:12.8px; flex-wrap:wrap; min-width:fit-content; }
.kpis .chip{
  padding:9.6px 12.8px; border:1px solid var(--border); border-radius:999px;
  background:var(--card); color:var(--text);
  font-family:"San Francisco Pro", -apple-system, BlinkMacSystemFont, sans-serif;
  font-weight:500; font-size:12.8px; line-height:14.64px; text-transform:uppercase;
}
.kpis .chip small{ color:var(--muted); font-weight:400; margin-left:8px; text-transform:none; }
.filters{ display:flex; gap:9.6px; flex-wrap:wrap; min-width:fit-content; }
button.filter{
  padding:9.6px 12.8px; border:1px solid var(--border); background:var(--card);
  color:var(--text); border-radius:10px; cursor:pointer;
  font-family:"San Francisco Pro", -apple-system, BlinkMacSystemFont, sans-serif;
  font-weight:500; font-size:12.8px; line-height:14.64px; text-transform:uppercase;
}
button.filter.active{ background:var(--accent); color:#FFFFFF; border-color:var(--accent); }

.rwd-table{ width:100%; border-collapse:collapse; font:14px/1.45 system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
.rwd-table th, .rwd-table td{ padding:10px 12px; border-bottom:1px solid #e7e7e7; vertical-align:top; }
.rwd-table th{ text-align:left; font-weight:600; background:#fafafa; }
.rwd-table tbody tr:hover{ background:#fcfcfc; }

/* десктоп: правый край для числовых колонок */
@media (min-width: 801px){
  .num { text-align:right; font-variant-numeric: tabular-nums; }
}

@media (max-width: 800px) {
  /* Скрываем шапку и делаем карточки */
  .rwd-table thead { display: none; }
  .rwd-table tr {
    display: grid;
    grid-template-columns: 1fr auto;
    align-items: center;
    gap: 10px;
    padding: 12px 8px;
    border-bottom: 1px solid #E0E0E0;
  }
  .rwd-table td { padding: 0; border: none; }
  .rwd-table td::before { content: ""; display: none; }

  /* По умолчанию скрываем все ячейки */
  .rwd-table td { display: none; }

  /* Показываем Эмитент (1), Результат (6) и Срок (7) */
  .rwd-table td:nth-child(1),
  .rwd-table td:nth-child(6),
  .rwd-table td:nth-child(7) { display: block; }

  /* Размещение */
  .rwd-table td:nth-child(1) { grid-column: 1; }
  .rwd-table td:nth-child(6),
  .rwd-table td:nth-child(7) { grid-column: 2; text-align: right; }

  /* Внешний вид правой колонки */
  .rwd-table td:nth-child(6) { font-size: 16px; font-weight: 500; }
  .rwd-table td:nth-child(7) { font-size: 13px; color: #666666; margin-top: -25px; }

  /* Открытые сделки: скрываем срок */
  .rwd-table tr[data-status="open"] td:nth-child(7) { display: none; }

  /* Дивиденды/Купон: тоже скрываем срок */
  .rwd-table tr[data-comment*="дивиден"] td:nth-child(7),
  .rwd-table tr[data-comment*="купон"] td:nth-child(7) { display: none; }

  /* ВАЖНО: старую синюю подсветку для дивидендов/купона убрали.
     Внешний вид теперь задаёт .status.open (как у «ОТКРЫТА»). */
}

/* Ячейки/стили */
.cell-num{
  text-align:center; font-variant-numeric:tabular-nums;
  font-family:"San Francisco Pro", -apple-system, BlinkMacSystemFont, sans-serif;
  font-weight:400; font-size:12.8px; line-height:1;
}
tbody tr:nth-child(even) { background-color: rgba(0,0,0,0.04); }
tbody tr:nth-child(odd)  { background-color: rgba(0,0,0,0.01); }
tbody tr:hover{ background:#F0F0F0; }
th.sortable{ cursor:pointer; }

.badge{
  padding:6.4px 9.6px; border-radius:999px;
  font-family:"San Francisco Pro", -apple-system, BlinkMacSystemFont, sans-serif;
  font-weight:500; font-size:12.8px; line-height:14.64px; text-transform:uppercase;
  display:inline-block;
}
.badge-up{ background:rgba(25,179,107,.15); color:#2ee69a; border:1px solid rgba(25,179,107,.35); }
.badge-down{ background:rgba(255,77,79,.15); color:#ff8082; border:1px solid rgba(255,77,79,.35); }
.badge-pause{ background:rgba(245,165,36,.15); color:#ffcc7a; border:1px solid rgba(245,165,36,.35); }
.badge-div{ background:rgba(78,161,255,.15); color:#93c7ff; border:1px solid rgba(78,161,255,.35); }
.badge-neutral{ background:#F0F0F0; color:#666666; border:1px solid #E0E0E0; }

.status{
  padding:6.4px 9.6px; border-radius:8px;
  font-family:"San Francisco Pro", -apple-system, BlinkMacSystemFont, sans-serif;
  font-weight:500; font-size:12.8px;
  line-height:14px; /* ПОЧИНЕНО: нормальное значение */
  text-transform:uppercase;
  display:inline-block;
}
.status.open{
  background:rgba(78,161,255,.12); color:#0047FF; border:1px solid rgba(78,161,255,.25);
}
.status.closed{
  background:rgba(25,179,107,.12); color:#2ee69a; border:1px solid rgba(25,179,107,.25);
}
.status.info{
  background:#F0F0F0; color:#666666; border:1px solid #E0E0E0;
}

.cell-date{ white-space:nowrap; font-family:"San Francisco Pro", -apple-system, BlinkMacSystemFont, sans-serif; font-weight:400; font-size:12.8px; line-height:1; }
.negative{ color:#EF3124; font-weight:700; }
.positive{ color:#2ee69a; font-weight:700; }

tfoot td{
  padding:12.8px 16px; color:var(--muted);
  font-family:"San Francisco Pro", -apple-system, BlinkMacSystemFont, sans-serif;
  font-weight:400; font-size:12.8px; line-height:1;
}
.small{ color:var(--muted); font-weight:400; font-size:12.8px; line-height:1; }
.footer{ margin-top:24px; color:var(--muted); text-align:center; font-weight:400; font-size:16px; line-height:1; }
</style>
</head>
<body>
<div class="container">
  <h1 style="font-family: Arial, sans-serif; font-weight: 700; font-size: 80px; line-height: 76px; text-transform: lowercase; margin: 0 0 32px;">Сделки «Ставка плюс»</h1>

  <div class="toolbar">
    <div class="search"><input id="searchBox" type="search" placeholder="Поиск по эмитенту, комментарию, дате..." style="padding: 10px 16px;"></div>
    <div class="kpis">
      <div class="chip">Всего: <span id="kpi-total">0</span><small></small></div>
      <div class="chip">Открытые: <span id="kpi-open">0</span></div>
      <div class="chip">Закрытые: <span id="kpi-closed">0</span></div>
    </div>
    <div class="filters">
      <button class="filter active" data-filter="all">ВСЕ</button>
      <button class="filter" data-filter="open">ОТКРЫТЫЕ</button>
      <button class="filter" data-filter="closed">ЗАКРЫТЫЕ</button>
      <button class="filter" data-filter="comment:рост">РОСТ</button>
      <button class="filter" data-filter="comment:падение">ПАДЕНИЕ</button>
      <button class="filter" data-filter="comment:тайм-аут">ТАЙМ-АУТ</button>
      <button class="filter" data-filter="comment:див">ВЫПЛАТЫ</button>
    </div>
  </div>

  <div class="table-wrap">
    <table id="signals" class="rwd-table">
      <thead>
        <tr>
          <th>Эмитент</th>
          <th>Дата открытия</th>
          <th>Комментарий</th>
          <th>Цена открытия</th>
          <th>Цена закрытия</th>
          <th>Результат</th>
          <th>Срок</th>
          <th>Статус</th>
        </tr>
      </thead>
      <tbody></tbody>
      <tfoot><tr><td colspan="8" class="small"></td></tr></tfoot>
    </table>
  </div>
  <div class="footer small"></div>
</div>

<script>
  // Лого по тикерам (можно дополнять)
  const logos = {
    'SBER': 'https://mybroker.storage.bcs.ru/FinInstrumentLogo/SBER.png',
    'T': 'https://mybroker.storage.bcs.ru/FinInstrumentLogo/T.png',
    'YDEX': 'https://via.placeholder.com/36x36?text=YDEX',
    'NVTK': 'https://mybroker.storage.bcs.ru/FinInstrumentLogo/NVTK.png',
    'X5': 'https://via.placeholder.com/36x36?text=X5',
    'SIBNBO03P15R': 'https://via.placeholder.com/36x36?text=SIBN',
    'PLZL': 'https://mybroker.storage.bcs.ru/FinInstrumentLogo/PLZL.png',
    'ОФЗ': 'https://via.placeholder.com/36x36?text=ОФЗ',
    'WUSH': 'https://via.placeholder.com/36x36?text=WUSH'
  };
</script>

<script id="data" type="application/json">
[
  {"Эмитент":"Сбербанк","Дата открытия":"01.08.2025","Тикер":"SBER","Цена открытия":"","Комментарий":"Дивиденды","Цена закрытия":383.2,"Дата закрытия":"01.08.2025","Результат":"","Срок":"0 дней"},
  {"Эмитент":"Т-Технологии","Дата открытия":"31.07.2025","Тикер":"T","Цена открытия":"","Комментарий":"Дивиденды","Цена закрытия":84.2,"Дата закрытия":"31.07.2025","Результат":"","Срок":"0 дней"},
  {"Эмитент":"Яндекс","Дата открытия":"25.07.2025","Тикер":"YDEX","Цена открытия":4265.88,"Комментарий":"РОСТ","Цена закрытия":4440.37,"Дата закрытия":"11.08.2025","Результат":"4.09%","Срок":"17 дней"},
  {"Эмитент":"Т-Технологии","Дата открытия":"25.07.2025","Тикер":"T","Цена открытия":3274.7,"Комментарий":"РОСТ","Дата закрытия":"Открыта","Результат":"","Срок":"В работе"},
  {"Эмитент":"Сбербанк","Дата открытия":"25.07.2025","Тикер":"SBER","Цена открытия":308.68,"Комментарий":"РОСТ","Дата закрытия":"Открыта","Результат":"","Срок":"В работе"},
  {"Эмитент":"Новатэк","Дата открытия":"25.07.2025","Тикер":"NVTK","Цена открытия":1053.8,"Комментарий":"РОСТ","Дата закрытия":"Открыта","Результат":"","Срок":"В работе"},
  {"Эмитент":"ИКС 5","Дата открытия":"23.07.2025","Тикер":"X5","Цена открытия":"","Комментарий":"Дивиденды","Цена закрытия":"907,2","Дата закрытия":"23.07.2025","Результат":"","Срок":"0 дней"},
  {"Эмитент":"Сбербанк","Дата открытия":"11.07.2025","Тикер":"SBER","Цена открытия":311.3,"Комментарий":"РОСТ","Цена закрытия":310.55,"Дата закрытия":"22.07.2025","Результат":"-0.24%","Срок":"11 дней"},
  {"Эмитент":"Новатэк","Дата открытия":"11.07.2025","Тикер":"NVTK","Цена открытия":1030.6,"Комментарий":"РОСТ","Цена закрытия":1082.51,"Дата закрытия":"24.07.2025","Результат":"5.04%","Срок":"13 дней"},
  {"Эмитент":"Т-Технологии","Дата открытия":"30.05.2025","Тикер":"T","Цена открытия":"","Комментарий":"Дивиденды","Цена закрытия":"100,8","Дата закрытия":"30.05.2025","Результат":"","Срок":"0 дней"},
  {"Эмитент":"ОФЗ 26247","Дата открытия":"28.05.2025","Тикер":"ОФЗ","Цена открытия":"","Комментарий":"Купон","Цена закрытия":"183,2","Дата закрытия":"28.05.2025","Результат":"","Срок":"0 дней"},
  {"Эмитент":"ОФЗ 26247","Дата открытия":"27.05.2025","Тикер":"ОФЗ","Цена открытия":862.74,"Комментарий":"РОСТ","Цена закрытия":835.22,"Дата закрытия":"17.06.2025","Результат":"-3.19%","Срок":"21 дней"},
  {"Эмитент":"SIBN корп. Обл.","Дата открытия":"27.05.2025","Тикер":"SIBNBO03P15R","Цена открытия":516.65,"Комментарий":"РОСТ","Цена закрытия":541.25,"Дата закрытия":"06.06.2025","Результат":"4.76%","Срок":"10 дней"},
  {"Эмитент":"Сбербанк","Дата открытия":"03.04.2025","Тикер":"SBER","Цена открытия":300.61,"Комментарий":"РОСТ","Цена закрытия":307.88,"Дата закрытия":"21.04.2025","Результат":"2.42%","Срок":"18 дней"},
  {"Эмитент":"Новатэк","Дата открытия":"03.04.2025","Тикер":"NVTK","Цена открытия":1188.47,"Комментарий":"РОСТ","Цена закрытия":1236.5,"Дата закрытия":"21.04.2025","Результат":"4.04%","Срок":"18 дней"},
  {"Эмитент":"Полюс Золото","Дата открытия":"02.04.2025","Тикер":"PLZL","Цена открытия":1769.53,"Комментарий":"РОСТ","Цена закрытия":1805.2,"Дата закрытия":"08.04.2025","Результат":"2.02%","Срок":"6 дней"},
  {"Эмитент":"Яндекс","Дата открытия":"17.03.2025","Тикер":"YDEX","Цена открытия":4592.81,"Комментарий":"РОСТ","Цена закрытия":4328.57,"Дата закрытия":"23.07.2025","Результат":"-5.75%","Срок":"128 дней"},
  {"Эмитент":"Т-Технологии","Дата открытия":"28.02.2025","Тикер":"T","Цена открытия":3219.68,"Комментарий":"РОСТ","Цена закрытия":3294.45,"Дата закрытия":"23.07.2025","Результат":"2.32%","Срок":"145 дней"},
  {"Эмитент":"ОФЗ 26248","Дата открытия":"18.02.2025","Тикер":"ОФЗ","Цена открытия":820.49,"Комментарий":"РОСТ","Цена закрытия":891.59,"Дата закрытия":"19.03.2025","Результат":"8.67%","Срок":"29 дней"},
  {"Эмитент":"ОФЗ 26247","Дата открытия":"18.02.2025","Тикер":"ОФЗ","Цена открытия":826.36,"Комментарий":"РОСТ","Цена закрытия":885.37,"Дата закрытия":"10.03.2025","Результат":"7.14%","Срок":"20 дней"},
  {"Эмитент":"ИКС 5","Дата открытия":"14.02.2025","Тикер":"X5","Цена открытия":3210.5,"Комментарий":"РОСТ","Цена закрытия":3198.29,"Дата закрытия":"09.07.2025","Результат":"-0.38%","Срок":"145 дней"},
  {"Эмитент":"Вуш","Дата открытия":"14.02.2025","Тикер":"WUSH","Цена открытия":194.05,"Комментарий":"РОСТ","Цена закрытия":222.51,"Дата закрытия":"26.02.2025","Результат":"14.67%","Срок":"12 дней"}
]
</script>

<script>
// Рендер
document.addEventListener('DOMContentLoaded', function() {
  if ('ontouchstart' in window) {
    document.documentElement.classList.add('touch-device');
    document.querySelectorAll('.table-wrap').forEach(el => { el.style.webkitOverflowScrolling = 'touch'; });
  }

  (function(){
    const data = JSON.parse(document.getElementById('data').textContent);
    const tbody = document.querySelector('#signals tbody');

    function badgeClass(t){
      const s=(t||'').toLowerCase();
      if(s==='рост') return 'badge-up';
      if(s==='падение') return 'badge-down';
      if(s==='тайм-аут') return 'badge-pause';
      if(s.includes('дивиден')) return 'badge-div';
      if(s.includes('купон')) return 'badge-div';
      return 'badge-neutral';
    }
    function statusOf(row){
      const dz=(row['Дата закрытия']||'').toString().trim().toLowerCase();
      const srok=(row['Срок']||'').toString().trim().toLowerCase();
      if(dz==='открыта' || srok==='в работе') return 'Открыта';
      return 'Закрыта';
    }
    function numSortVal(v){
      const s=(v??'').toString().trim().replace(/\s+/g,'').replace('%','').replace(',','.');
      const n=parseFloat(s);
      return isNaN(n)?'':n;
    }
    function dateSortVal(v){
      const s=(v??'').toString().trim();
      if(!s || s.toLowerCase()==='открыта') return '9999-12-31';
      const m=s.match(/(\d{2})\.(\d{2})\.(\d{4})/);
      return m? `${m[3]}-${m[2]}-${m[1]}` : s;
    }

    data.forEach(row=>{
      const status = statusOf(row);
      const statusClass = status==='Открыта' ? 'open' : (status==='Закрыта' ? 'closed':'info');
      const tr = document.createElement('tr');
      tr.dataset.status = statusClass;
      tr.dataset.comment = (row['Комментарий']||'').toString().toLowerCase();

      const res=(row['Результат']||'').toString().trim();
      const resHtml = res ? (res.startsWith('-')
        ? `<span class="negative">${res}</span>`
        : `<span class="positive">${res}</span>`) : '';

      const ticker = (row['Тикер'] || '').toString().trim();
      const logoUrl = logos[ticker];
      const logoHtml = logoUrl
        ? `<div style="display: flex; align-items: center; gap: 12px;">
            <img src="${logoUrl}" alt="${ticker}" style="width: 36px; height: 36px; border-radius: 50%; object-fit: cover;">
            <div style="display: flex; flex-direction: column; align-items: flex-start;">
              <span class="bold-emitent">${row['Эмитент'] || ''}</span>
              <span class="small" style="font-size: 14px;">${ticker}</span>
            </div>
          </div>`
        : (row['Эмитент'] || '');

      /* === Результат: выполняем требование ===
         - Если комментарий Дивиденды/Купон:
           ПК -> ничего; Мобайл -> плашка как "ОТКРЫТА" с текстом комментария
         - Иначе: если статус Открыта -> плашка "ОТКРЫТА", иначе число/процент
      */
      const commentRaw = (row['Комментарий'] ?? '').toString();
      const lc = commentRaw.toLowerCase();
      const isDivOrCoupon = lc.includes('дивиден') || lc.includes('купон');

      const resultCellHtml = isDivOrCoupon
        ? `<span class="desktop-only"></span><span class="only-mobile status open">${commentRaw}</span>`
        : (status === 'Открыта'
            ? '<span class="status open">ОТКРЫТА</span>'
            : resHtml);

      tr.innerHTML = `
        <td class="bold-emitent" data-label="Эмитент">${logoHtml}</td>
        <td class="cell-date" data-sort="${dateSortVal(row['Дата открытия'])}" data-label="Дата открытия">${row['Дата открытия']||''}</td>
        <td data-label="Комментарий"><span class="badge ${badgeClass(row['Комментарий'])}">${row['Комментарий']||''}</span></td>
        <td class="cell-num num" data-sort="${numSortVal(row['Цена открытия'])}" data-label="Цена открытия">${row['Цена открытия']??''}</td>
        <td class="cell-num num" data-sort="${numSortVal(row['Цена закрытия'])}" data-label="Цена закрытия">${row['Цена закрытия']??''}</td>
        <td class="cell-num" data-sort="${numSortVal(row['Результат'])}" data-label="Результат">${resultCellHtml}</td>
        <td style="white-space: nowrap" data-label="Срок">${row['Срок']||''}</td>
        <td data-label="Статус"><span class="status ${statusClass}">${status}</span></td>
      `;
      tbody.appendChild(tr);
    });

    // KPI (считаем по фактически отрендеренным строкам)
    const rows = tbody.querySelectorAll('tr');
    document.getElementById('kpi-total').textContent  = rows.length;
    document.getElementById('kpi-open').textContent   = [...rows].filter(r=>r.dataset.status==='open').length;
    document.getElementById('kpi-closed').textContent = [...rows].filter(r=>r.dataset.status==='closed').length;

    // Поиск
    const searchBox=document.getElementById('searchBox');
    searchBox.addEventListener('input', function() {
      const q = this.value.trim().toLowerCase();
      tbody.querySelectorAll('tr').forEach(tr => {
        tr.style.display = tr.textContent.toLowerCase().includes(q) ? '' : 'none';
      });
    });

    // Фильтры
    const buttons=document.querySelectorAll('button.filter');
    let activeFilter='all';
    buttons.forEach(btn=>{
      btn.addEventListener('click',()=>{
        buttons.forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        activeFilter=btn.dataset.filter;
        applyFilters();
      });
    });
    function applyFilters() {
      const rows = tbody.querySelectorAll('tr');
      const searchQuery = searchBox.value.trim().toLowerCase();

      rows.forEach(tr => {
        const status = tr.dataset.status;
        const comment = tr.dataset.comment || '';
        const text = tr.textContent.toLowerCase();

        let show = true;
        if (activeFilter !== 'all') {
          if (activeFilter === 'open' && status !== 'open') show = false;
          else if (activeFilter === 'closed' && status !== 'closed') show = false;
          else if (activeFilter.startsWith('comment:')) {
            const key = activeFilter.split(':')[1];
            if (key === 'див') {
              if (!comment.includes('дивиден') && !comment.includes('купон')) show = false;
            } else if (!comment.includes(key)) show = false;
          }
        }
        if (show && searchQuery && !text.includes(searchQuery)) show = false;
        tr.style.display = show ? '' : 'none';
      });
    }
  })();
});
</script>

<noscript>
  <div class="table-wrap">
    <table class="rwd-table">
      <thead>
        <tr>
          <th>Эмитент</th>
          <th>Дата открытия</th>
          <th>Комментарий</th>
          <th>Цена открытия</th>
          <th>Цена закрытия</th>
          <th>Результат</th>
          <th>Срок</th>
          <th>Статус</th>
        </tr>
      </thead>
      <tbody><!-- Static fallback --></tbody>
    </table>
  </div>
</noscript>
</body>
</html>
